{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Understanding the Problem","text":"<p>This documentation covers the public facing outputs of a discrete event simulation focussing on simulating the ambulance job cycle time.  The work has been made open to support:</p> <ul> <li>Reuse of the code-base by an analyst with access to ambulance data.  In this situation the code should be forked and adapted locally to ingest the trust specific data and trajectory.   We have attempted to include enough information around the parameters and inputs used to allow this refactoring to new data. </li> <li>An example of using the open R library RSimmer for a healthcare discrete event simulation.  We have tried to include enough information around the approach and considerations to be useful for wider simulations. </li> </ul>"},{"location":"#context-of-the-specific-simulation","title":"Context of the Specific Simulation","text":"<p>Ambulance handover problems have been dominating the Urgent &amp; Emergency Care (UEC) space. Over the past couple of years there have been large handover delays, with a lot of people waiting a long time to be admitted into the emergency department (ED). </p> <p> </p>"},{"location":"#understandingaddressing-the-problem","title":"Understanding/Addressing the Problem","text":"<p>When a call is made, availability to respond to it depends namely on the number of on-duty ambulance fleet, the on-duty workforce but also the instantaneous availability to be allocated to that incoming call. This in turn depends on when on-duty ambulances can be cleared from previous jobs (finish their job cycle time from allocation to clearance). Handover delays are leading to more ambulances queueing at the hospital site and an increase in job cycle time, which affects their availability for subsequent jobs.</p> <p>Much of it may not be in the sole direct gift of the ambulance service, as ability to handover depends on A&amp;E availability for clinical handover, which may in turn be affected by, successively: A&amp;E occupancy, bed availability in admitted patient care, inpatient discharge (to home, social care, \u2026). It is useful though to better understand the ambulance setting and how different factors affect performance. Namely, the relation between handover delays and response times, the impact of resourcing models, changes to job cycle time or fluctuations in demand.</p>"},{"location":"#problem-statement-to-be-modelled","title":"Problem Statement to be Modelled","text":"<p>In the context of ambulance to emergency department handover delays and elevated ambulance response times, build a prototype discrete event simulation model (DES) for the ambulance setting to help understand the potential impacts of:</p> <ul> <li>resourcing interventions</li> <li>factors such as demand, job cycle time components, vehicle capacity</li> </ul> <p>on:</p> <ul> <li>ambulances queueing at hospital site</li> <li>calls queued</li> <li>call response times</li> <li>handover times</li> </ul> <p>An overview of the response time problem restated as a queue is given below. Queues for ambulances to handover at the site can also emerge.</p> <p> </p>"},{"location":"#methodological-approach-discrete-event-simulation","title":"Methodological Approach - Discrete Event Simulation","text":"<p>As the dynamics to be modelled are flows and resource utilisation, a system model is required.  As we are interested in understanding the profiles tails and not just the medians and expected to include individual effects in the model (e.g. reneging and queue prioritisation depending on individual characteristic) a Discrete Event Simulation (DES) is considered.  This approach models systems as networks of queues and activities, where state changes in the system occur at discrete points embedded in continuous time.  This means that many system events can happen in a single time point, one after another, followed by many time points where no update occurs. The objects in the system are distinct individuals, each possessing characteristics that determine what happens to that individual, and the activity durations are sampled for each individual from probability distributions.  Discrete Event Simulations are essentially stochastic in nature.  </p> <p>This method has the advantage of intuitive and visual checks to the logic model, scenario testing and granular modelling.  The restrictions of DES are mainly around the simplified model of the system not picking up dynamic behaviours.  This means that absolute values should not be used for direct comparisons with reality but instead to inform a discussion of the underlying causalities and impacts of changes on the system.</p> <p>Discrete event simulations have been widely used for a long time across a variety of industries including queuing logic (e.g. airport customs), assembly lines (e.g. return on investment from prioritising one product line over another), and resource management (e.g. operating theatres).  </p> <p>Other techniques that could be considered for this work are: queuing theory; Markov chains; process mapping; or system dynamics.</p> <p>(Full screen here.)</p>"},{"location":"#model-design","title":"Model Design","text":"<p>A successful system model needs to have:</p> <ul> <li>Well-defined scope</li> <li>Available Data flows at the right level of granularity</li> <li>Known unknowns with evidenced-based assumptions</li> <li>Separate validation metrics</li> <li>Benchmarks if possible</li> </ul> <p>In order to build a model that will have longevity, can be worked on by multiple individuals and where components can be reused in future projects we have pushed for a version controlled, free and open source solution.  </p> <p>A key learning from previous related projects is that there is often a strong desire to jump from the problem to the solution.  Instead we must ensure to work through two additional stages of considering a representative model and creating from this a simplified / optimized model to generate the solution from. </p> <p> </p> <p>The rest of this documentation will be split across these four steps. </p>"},{"location":"chosenmethod/","title":"Chosen method","text":"<p>As the dynamics to be modelled are flows and resource utilisation, a system model is required. As we are interested in understanding the profiles tails and not just the medians and expected to include individual effects in the model (e.g. reneging and queue prioritisation depending on individual characteristic) a Discrete Event Simulation (DES) is considered. </p> <p>This approach models systems as networks of queues and activities, where state changes in the system occur at discrete points embedded in continuous time. This means that many system events can happen in a single time point, one after another, followed by many time points where no update occurs. </p> <p>The objects in the system are distinct individuals, each possessing characteristics that determine what happens to that individual, and the activity durations are sampled for each individual from probability distributions. Discrete Event Simulations are essentially stochastic in nature.</p> <p>This method has the advantage of intuitive and visual checks to the logic model, scenario testing and granular modelling. Discrete event simulations have been widely used for a long time across a variety of industries including queuing logic (e.g. airport customs), assembly lines (e.g. return on investment from prioritising one product line over another), and resource management (e.g. operating theatres).</p> <p>The restrictions of DES often come down to simplifications you have had to make due to missing data or complexity meaning the model misses  dynamic behaviours in the system. This means that absolute values should not be used for direct comparisons with reality but instead to inform a discussion of the underlying causalities and impacts of changes on the system.</p> <p>Other techniques that could be considered for this work are: queuing theory; Markov chains; process mapping; or system dynamics.</p> <p>Suggest using the open source R package RSimmer building off the back of previous\u00a0work. SimPy was also considered but this requires a significant setup time to create the simulation objects and logging.  A Large range of licensed software was also considered but it is preferable to work in software which is more collaborative and we don't imagine needing the additional functionality that the licensed software brings for this task.</p> <p>Considering the problem as a series of component modules we can draw a high level model</p> <p> </p>"},{"location":"config/","title":"User Settings (Config)","text":"<p>The <code>config.R</code> file contains all the user parameters and controls for the model.  These can be categorised into several groups of parameters.</p> <p>The below shows these parameters with a default assignment but this can be changed.</p>"},{"location":"config/#batch-run-parameters","title":"batch run parameters","text":"Parameter Use nreps = 10 # number of replications"},{"location":"config/#simulation-parameters","title":"simulation parameters","text":"Parameter Use n_days_week &lt;- 7 # days in a week. constant g.tday = 24*60 # minutes in a day. constant."},{"location":"config/#simulation-parameters-only-used-if-demand-flag-not-from-file","title":"simulation parameters (only used if demand flag not from file)","text":"Parameter Use ambu_day &lt;- 100 # Parameter to poisson , only used if demand not from file.  120 is typical daily avg per most affected trusts, but varies considerably. n_days_warm &lt;- 1 # days of warm-up , if demand not from file, only used to dictate time to remove for output KPI purposes. n_days_study &lt;- 14 # days to observe , only used if demand not from file ndays &lt;- n_days_warm + n_days_study # days of study (warm-up + observe), only used if demand not from file g.tmax=24 60 ndays; # one day . Note: this may be different to implied by schedules."},{"location":"config/#fallback-simulation-parameters-only-used-if-jct-error-in-loading-from-file-except-gt_prehandoverxed-and-gt_allocatetomobilise","title":"Fallback simulation parameters (only used if JCT error in loading from file, except g.T_prehandoverXed and g.T_allocatetomobilise)","text":"Parameter Use g.T_allocatetomobilise=0 # Time period from allocate to mobilise. g.T_traveltoscene &lt;- 22 # Time period to travel to scene. 22 to match travel to hospital. Under assumption that ambulances can't travel from their optimal spot. All pivot back and forth from site. g.T_atscene &lt;- 36 # Time period at scene. g.T_traveltohospital &lt;- 22 # Time period to travel to hospital site. g.T_prehandover_LN # Time period for pre-handover. Define the logmean, logsd, offset g.T_clear=5 # Time period for clearance g.T_prehandoverXed &lt;- 40 # Assumed period to pre-handover for X ED conveyances g.T_prehandover_LN_median # Derived field. Time period for pre-handover. Median from distribution g.T_prehandover_LN_mean # Derived field. Time period for pre-handover. Mean from distribution"},{"location":"config/#fallback-capacity-simulation-parameters-only-used-if-capacity-flag-not-from-file","title":"Fallback capacity simulation parameters (only used if capacity flag not from file)","text":"Parameter Use n_ru0 &lt;- 500 # number of staff (pool) - ideally twice of n_dsav0 (assuming all DSA vehicles and desired full use) n_dsav0 &lt;- 250 # number of double-staff vehicles (pool) n_mobile0 &lt;- min(floor(n_ru0/2),n_dsav0) # Derived field"},{"location":"config/#set-the-ae-parameters","title":"Set the A&amp;E parameters","text":"Parameter Use flag_supply_schedule_file_hED &lt;- TRUE # whether to use (unscaled) seasonal ED variation from Dnc file. If so, n_AEbays will be used as average A&amp;E bays over time horizon flag_LoS_file &lt;- FALSE # whether LoS should come from file. T_AE &lt;- 6.5 # period in AE (used if not loaded from file) , in hours n_AEbays &lt;- 1500*1 # number of A&amp;E bays / A&amp;E capacity t_AEsupplyshock &lt;- 7 24 60 # when to apply supply shock, in minutes from t0 dn_AEsupplyshock &lt;- 0 # number of bays to change by, upon shock (for decrease, use negative number)"},{"location":"config/#what-if-parameters","title":"What-if parameters","text":"Parameter Use tamper_dsa_flag &lt;- FASE # whether to tamper with DSA supply tamper_dsa_f &lt;- 1 # factor by which to tamper by (1 is 'equal' / no tampering ; 1.10 and 0.9 are tampering upwards and downwards by 10%) tamper_HO_flag &lt;- FALSE # whether to tamper with handover tamper_HO_f &lt;-1 # factor by which to tamper by (1 is 'equal' / no tampering ; 1.10 and 0.9 are tampering upwards and downwards by 10%) tamper_HT_flag &lt;- FALSE # whether to 'tamper' with H&amp;T (F2F portion) tamper_HT_pp &lt;- 5 # the %p of F2F incidents to become H&amp;T, from S&amp;T - only cat3,4 tamper_ST_flag &lt;- FALSE # whether to 'tamper' with S&amp;T (conveyance) tamper_ST_pp &lt;- 0 # the %p to increase S&amp;T by, from S&amp;C - only cat3,4 DSV_holdout_flag = FALSE # flag for use of holdout (if so, part of resource is put aside and can only be used by cat1 in given circumstances) DSV_holdout_perc = 0.2 # percentage of on-duty fleet that is holdout DSV_holdout_use_minqueue = 100 # minimum queue in for ain DSV in order to allow holdout to be used flag_EDpriority_adjust = TRUE # whether to do some deprioritising of direct vs ambulance at same acuity p_direct_deprio &lt;- 0.2 # the probability of direct being deprioritised compared to ambulance with same acuity"},{"location":"config/#escalationtrigger-parameters","title":"escalation/trigger parameters","text":"Parameter Use flag_renege &lt;- FALSE # whether to allow reneging (cat3,4) T_renege &lt;- 18*60 # time in minutes after which an arrival will renege p_renege_directED &lt;- 0.25 # probability that reneges will instead go straight to ED (rather than 'step down') catmin_renege &lt;- 3 # minimum category where reneges happen flag_stepcat &lt;- TRUE # whether to allow calls to increase in priority after a time X T_stepcat &lt;- 7*60 # time in minutes after which to increase priority catmin_stepcat &lt;- 3 # minimum category for which this should apply (towards lower acuities) flag_balk_amb &lt;- FALSE # whether to allow balking. If FALSE, nqueue_balk will be overwritten to 'Inf' nqueue_balk &lt;- 500 # threshold of queue size from whick balking occurs no_ambulancesqueueingbreach &lt;- 10 # no ambulances queueing in site for it to count as breach from new ambulance arrival perspective no_arrivalbreaches &lt;- 10 # trigger point: nr of arrivals in time window that observe queue length breach. flag_dynamics &lt;- FALSE # whether to allow for Cat3 conveyance to dynamically adjust based on pressure T_window_escalation_hours&lt;-8 # cycle for escalation checks and also window used for KPI computation that informs escalation, in hours"},{"location":"config/#schedule-parameters","title":"Schedule parameters","text":"Parameter Use flag_demand_schedule &lt;- TRUE # whether demand (poisson rate) should vary per hour (given in file) . nb not disaggregated by cat flag_supply_schedule &lt;- TRUE # whether supply should follow a schedule flag_supply_schedule_file &lt;- TRUE # whether this schedule comes from the file T_window_hours&lt;- 8 # hours per window"},{"location":"config/#scenario-run-mode-parameters","title":"Scenario 'Run Mode' parameters","text":"Parameter Use flag_scenarios &lt;- TRUE # whether to use scenario runs . Do not edit the below if under the 'else' statement (single scenario) vec_T_AE = c(T_AE) # vector for time in A&amp;E (hours) vec_tamper_dsa_flag=c(TRUE) # vector for DSA flag vec_tamper_dsa_f = c(1) # vector for DSA factor vec_tamper_HT_flag = c(FALSE) # vector for H&amp;T flag vec_tamper_HT_pp = c(0) # vector for H&amp;T p.p. change vec_tamper_ST_flag = c(FALSE) # vector for S&amp;T flag vec_tamper_ST_pp = c(0) # vector for S&amp;T p.p. change"},{"location":"config/#plotting-parameters","title":"Plotting parameters","text":"Parameter Use val_months = c(\"Month1\",\"Month2\",\"Month3\") # not for editing val_month = val_months[1] # change between 1,2,3 for some reference lines from publications to appear in graphs"},{"location":"config/#saving-parameters","title":"Saving parameters","text":"Parameter Use flag_savedata_overallKPIs = T # flag on whether to save overall KPI files flag_savedata_stepwiseKPIs = T # flag on whether to save stepwise KPI files flag_savedata_fulllogs = F # flag on whether to save full logs flag_saveplots = T # flag on whether to save plots flag_patientpathplot = F # plot(trajectory) g.debug=0 # how many levels of depth of log detail to print. #0 for least."},{"location":"contact/","title":"Contact","text":"<p>This work was undertaken during early 2023 by colleagues within the Digital Analytics and Research team (DART) in the Transformation Directorate of NHS England.</p> <p>See other open projects from the wider NHSE Data Science community here or get in contact by emailing datascience@nhs.net.</p>"},{"location":"data/","title":"Data Sources (Inputs)","text":"<p>Outlined below are Data Sources identified and requested for this work.</p> <p>Note: Other data sources or insights may be available to other users. The code has been constructed such that the user can feed in their own information.</p>"},{"location":"data/#non-public-data-sources","title":"Non Public Data Sources","text":"<p>For our this work we requested granular profiles rather than record level data. This is outlined below.</p>"},{"location":"data/#computer-aided-dispatch-cad-ambulance-data-set-ads","title":"Computer Aided Dispatch (CAD) / Ambulance Data Set (ADS)","text":"<ul> <li>Profile of relative demand by hour of a day (by category, conveyance)</li> <li>Job Cycle Time (JCT) components - mean, standard deviation, percentiles (by category, conveyance)</li> <li>Relation between incident category and: ED acuity, ED length of stay</li> </ul>"},{"location":"data/#emergency-care-data-set-ecds","title":"Emergency Care Data Set (ECDS)","text":"<ul> <li>Portion of ED Demand that is direct vs non-ambulance</li> <li>Relation between being a walk-in and: ED acuity, ED length of stay</li> </ul>"},{"location":"data/#national-ambulance-coordination-centre-nacc-report","title":"National Ambulance Coordination Centre (NACC) report","text":"<ul> <li>Double Staffed Ambulance (DSA) fleet on-duty</li> <li>Rapid Response Vehicle (RRV) on-duty</li> <li>ED Cohorting</li> <li>Escalation status</li> </ul>"},{"location":"data/#daily-ambulance-collection","title":"Daily Ambulance Collection","text":"<ul> <li>Profile of ambsolute and relative daily demand (demand as: \u2018F2F incidents\u2019; \u2018Incidents\u2019; \u2018Calls Answered\u2019, \u2018Contacts\u2019)</li> <li>Absolute and relative (F2F) demand by category and care model</li> <li>Mean and 90th Response times daily trend</li> <li>Handover metrics daily trend</li> </ul>"},{"location":"data/#public-data-sources","title":"Public Data Sources","text":""},{"location":"data/#ambulance-quality-indicators","title":"Ambulance Quality Indicators","text":"<p>NHS England, Ambulance Quality Indicators</p> <ul> <li>Mean and 90th Response times </li> <li>Relative (F2F) demand by category</li> <li>Relative demand by care model</li> <li>Vehicles dispatched per incident and category</li> <li>Vehicles arriving at scene per incident and category</li> </ul>"},{"location":"examplerun/","title":"Starting a run","text":""},{"location":"examplerun/#code-setup","title":"Code Setup","text":"<p>The following steps will likely be necessary ahead of the first run:</p> <ul> <li>Clone the repository to a folder location of choice;</li> <li>Open R Studio;</li> <li>Open the R project of AmbModelOpen in the parent folder (double click <code>ambsim.Rproj</code>)<ul> <li>Check: when running<code>getwd()</code> from the R console, the working directory should now be set to the cloned folder location <code>AmbModelOpen</code>.</li> </ul> </li> <li>Open <code>packages.R</code> and run this file. This will likely throw errors as some (or all) packages are not installed.</li> <li>In <code>packages.R</code> set <code>flag_install_packages &lt;- TRUE</code> and add the relevant packages to be installed in <code>c_packagestoinstall</code> . For example, if <code>tidyverse</code> and <code>simmer</code> need installing, write <code>c_packagestoinstall &lt;- c(\"tidyverse\",\"simmer\")</code>. Run the code.</li> <li>Once all relevant packages have been installed explicitly set <code>flag_install_packages &lt;- FALSE</code> to make sure the programme does not reinstall each time it is run.</li> </ul>"},{"location":"examplerun/#starting-a-run-first-run","title":"Starting a run (first run)","text":"<p>To get an example run going, follow the following steps:</p> <ul> <li>For a first run, use the code files (<code>./src</code>) as given in the main branch as default (as there have already been set up to align with a given scenario).</li> <li>Open <code>main.R</code> . Use <code>mydate</code> to change the name of the subfolder to which the results should be saved (within <code>AmbModel/Output</code>). e.g. to name it \"myexamplerun\" set <code>mydate &lt;- \"myexamplerun\"</code>.</li> <li>The run has been set to use scenario folder <code>Fake_Data_2</code> for reading inputs (in <code>/parameter</code> subfolder).</li> <li>\"Select all\" in <code>main.R</code> and then press <code>run</code> or <code>Ctrl+R</code>. The run may take some minutes given it is set to run 10 replications, each covering a 15 day simulation time period for a whole ambulance trust footprint.</li> <li>After the run, some results will be printed to the Console or the Plots viewer. A range of relevant outputs will be saved to the folder selected above, e.g. <code>./Outputs/myexamplerun/</code> .</li> <li>This should have successfully concluded a run!</li> </ul>"},{"location":"examplerun/#creating-my-own-custom-scenario-and-run","title":"Creating my own custom scenario and run","text":"<p>The code was made with the expectation that an end-user would only potentially update:</p> <ul> <li><code>main.R</code> (lines 22-23)<ul> <li><code>scenario_folder</code> to specify the name of the parameter scenario folder to use (an existing subfolder of AmbModelOpen/parameters that the user worked on)</li> <li><code>mydate</code> to specify the name of the folder where results should be saved (will appear in AmbModelOpen/Outputs).</li> </ul> </li> <li><code>config.R</code> - a range of configurable settings</li> <li>a <code>/parameter</code> subfolder similar to <code>/parameter/Fake_Data_2</code> to change inputs on demand, supply, job cycle time components and pathway probabilities.<ul> <li>The user can create a copy of the <code>Fake_Data_2</code> folder (e.g. <code>Fake_Data_3</code>), update parameters as desired and run the model with <code>scenario_folder &lt;- \"Fake_Data_3</code>.</li> </ul> </li> </ul>"},{"location":"examplerun/#understanding-the-configr-file-reference","title":"Understanding the config.R file (reference)","text":"<p>See Optimised Model - User Settings (Config) to understand further user settings in the <code>config.R</code> file.</p>"},{"location":"examplerun/#understanding-how-to-update-parameter-input-files-user-guide","title":"Understanding how to update parameter input files (user guide)","text":"<p>See User guide - Parameter input files to understand the Scenario input files and when / how / if they get used via <code>Input.R</code> and in the DES model runs.</p>"},{"location":"examplerun/#an-overview-of-parameter-inputs-reference","title":"An overview of parameter inputs (reference)","text":"<p>See Optimised Model - Inputs for an overview of Input use in the model (from Scenario input files).</p>"},{"location":"examplerun/#understanding-the-output-files","title":"Understanding the output files","text":"<p>An overview of output files is given in Overview of output files.</p>"},{"location":"glossary/","title":"Glossary and reference","text":""},{"location":"glossary/#acronyms","title":"Acronyms:","text":"<ul> <li>ambsim \u2013 legacy shorthand for the ambulance simulation model in this report.</li> <li>A&amp;E \u2013 accident and emergency</li> <li>ADS \u2013 ambulance data set</li> <li>AQI \u2013 ambulance quality indicators</li> <li>CAD \u2013 computer aided dispatch</li> <li>Cat - category</li> <li>CM - care model</li> <li>Cat2-RT \u2013 category 2 mean response time</li> <li>dAC \u2013 daily ambulance collection</li> <li>DART \u2013 digital analytics and research team</li> <li>DES \u2013 discrete event simulation</li> <li>DCA/DSV \u2013 double crewed ambulance / double staffed vehicle</li> <li>ECDS \u2013 emergency care data set</li> <li>ED \u2013 emergency department</li> <li>F2F \u2013 face to face</li> <li>H&amp;T \u2013 hear and treat</li> <li>HO - handover</li> <li>HO30+ - handover 30+ minutes (%)</li> <li>HO60+ - handover 30+ minutes (%)</li> <li>JCT \u2013 job cycle time</li> <li>KPI \u2013 key performance indicator</li> <li>LoS - length of stay (nb: in this context this is meant as time in A&amp;E department rather than inpatient length of stay)</li> <li>NACC \u2013 national ambulance coordination centre</li> <li>RRV \u2013 rapid response vehicle</li> <li>S&amp;C \u2013 see and convey</li> <li>S&amp;T \u2013 see and treat</li> <li>TLAHD - time lost to ambulance handover delays</li> <li>tts - time to scene</li> <li>ttsi - time to site</li> <li>tas - time at scene</li> <li>ttc - time to clear</li> <li>UEC \u2013 urgent and emergency care</li> <li>YTD \u2013 year to date</li> </ul>"},{"location":"glossary/#conventions-in-this-repo","title":"Conventions (in this repo):","text":"<ul> <li>Care Model (CM)<ul> <li>1 = See and Convey</li> <li>2 = See and Treat</li> <li>3 = Hear and Treat</li> <li>99 = n/a , for instance walk-in</li> </ul> </li> <li>Category (Cat)<ul> <li>1 = Category 1 (life-threatening)</li> <li>2 = Category 2 (emergency)</li> <li>3 = Category 3 (urgent)</li> <li>4 = Category 4 (less urgent)</li> <li>99 or blank = n/a, for instance walk-in</li> </ul> </li> </ul>"},{"location":"glossary/#standards-national","title":"Standards (national):","text":"<p>A subset is outlined below.</p>"},{"location":"glossary/#response-times","title":"Response times","text":"<p>As per the AmbSYS specification, ambulance services should achieve these standards:</p> <p></p> <p>these are published monthly via the Ambulance Quality Indicators collection.</p>"},{"location":"glossary/#handover-delays","title":"Handover delays","text":"<p>National guidance states that ambulance patients arriving at ED should have clinical handover within 15 minutes. Daily data is collected on handover delays over 30 minutes and 60 minutes, as well as total time lost to handover delays. In Winter, this is published via the Urgent and Emergency Care Daily Situation Reports.</p>"},{"location":"illustrativequestions/","title":"Illustrative questions","text":""},{"location":"illustrativequestions/#illustrative-questions","title":"Illustrative questions","text":"<p>An example of illustrative questions for prescriptive analysis are shown below. These analyses, if used, are not meant as standalone but as an augmented aid to decision-making alongside subject-matter expertise, existing operational models and existing evidence-based interventions.</p> <p>These questions are also more focussed on operational performance. While inter-related, they would need considering alongside other dimensions such as staff welbeing, patient clinical outcomes, demographic variation and wider system performance.</p> <ul> <li> <p>What-if and sensitivity | What happens to response times and vehicle availability when:</p> <ul> <li>Vehicle on-duty hours increase</li> <li>Supply schedule is changed</li> <li>Demand increases</li> <li>Demand by category varies</li> <li>Hear-and-treat rate is changed</li> <li>Rate of conveyance is changed</li> <li>Conveyance to ED (rather than elsewhere) is changed</li> <li>Specific job cycle time component times decrease</li> <li>\u201cED pressure\u201d changes (via ED \u2018resource nr\u2019 or \u2018time in department\u2019 parameters)</li> <li>One or more of the parameters above is changed to be equal to another benchmark organisation?</li> <li>One of the parameters above is changed to be equal to pre-pandemic levels or historic growth</li> <li>All parameters resemble pre-pandemic levels or historic growth, apart from one</li> </ul> </li> <li> <p>Goal-seek | What type of change to one of the levels above delivers a given level of availability (or other KPI) improvement)</p> </li> <li> <p>Return | Under which (e.g. varying levels of A&amp;E pressure)  conditions do the levers/interventions above provide diminishing returns or lower effectiveness.</p> </li> <li> <p>Dynamics | What happens to response times, availability and the use of escalations (compared to a \u2018no escalation\u2019 pressure scenario) when these dynamic escalations are allowed to occur:</p> <ul> <li>Patients are allowed to balk to a certain extent</li> <li>Patients are allowed to renege to a certain extent</li> <li>Conveyance rates are sensitive to pressure</li> </ul> </li> </ul>"},{"location":"inputs/","title":"Inputs","text":""},{"location":"inputs/#overview","title":"Overview","text":"<p>The core model inputs can be mainly grouped into the following:</p> <ul> <li>Demand and flow<ul> <li>Ambulance demand (t)<ul> <li>volume (t)</li> <li>by category (t)</li> <li>by care model</li> <li>by conveyance destination</li> </ul> </li> <li>Direct demand (t)</li> </ul> </li> <li>Supply (t)<ul> <li>Ambulance supply (t)</li> <li>ED supply (t)</li> </ul> </li> <li>Job Cycle Time components<ul> <li>Time to scene</li> <li>Time at scene</li> <li>Time to site</li> <li>Unavoidable pre-handover</li> <li>Time to clear</li> <li>(nb: Time to Allocate and Time to Pre-handover (Avoidable) are not user inputs, they are emerging outputs from the model given demand and supply)</li> </ul> </li> <li>ED Management<ul> <li>ED acuity for Direct ; ambulance category</li> <li>ED time in department</li> </ul> </li> </ul> <p>The <code>(t)</code> indicates which ones can be given by the user in a time-resolved (hour-by-hour) way.</p>"},{"location":"inputs/#configuration-of-inputs-in-the-code","title":"Configuration of inputs in the code","text":"<p>While <code>inputs.R</code> is the main script for loading in Input parameter files for model run purposes, this file would typically not be updated by an end-user, with all user updates being done in the Input parameter files themselves (within <code>./parameter/__/</code>) and <code>config.R</code>.</p>"},{"location":"inputs/#overview-by-type","title":"Overview by type","text":"<p>The resulting Inputs for demand, supply, and timings were taken from the identified data sources. Below some examples are given (though other options are possible).</p> <p>For a more detailed walk-through on the use of Parameter Input Files, see User guide - Parameter input files.</p> <p>For a more detailed walk-through of <code>config.R</code>, see User Settings (Config).</p>"},{"location":"inputs/#demand-hourly-schedule","title":"Demand - Hourly Schedule","text":"<p>The demand schedule is made up of a dataframe which covers hourly arrivals for:</p> <ul> <li>Number of ambulance incidents (calculated from hourly and weekday proportions of actual number of incidents from selected geography in selected time period)</li> <li>Number of direct ED walk-in demand (calculated from hourly and weekday proportions of uplifted number of incidents by a factor of 1.736)</li> </ul> <p></p> <p>Note: other options available, see User guide - Parameter input files.</p>"},{"location":"inputs/#demand-and-flow-category","title":"Demand and Flow - Category","text":"<p>When patients are generated as demand in the model, they are assigned a category. This can be set as either time-variant or time-invariant.</p> <p>Time-variant:</p> <ul> <li>Proportion of Category1 ambulances (calculated from actual numbers of cat 1 ambulance calls multiplied by hourly profiles)</li> <li>Proportion of Category2 ambulances (calculated from actual numbers of cat 2-4 ambulance calls multiplied by hourly profiles and category proportion)</li> <li>Proportion of Category3 ambulances (calculated from actual numbers of cat 2-4 ambulance calls multiplied by hourly profiles and category proportion)</li> <li>Proportion of Category4 ambulances (calculated from actual numbers of cat 2-4 ambulance calls multiplied by hourly profiles and category proportion)</li> </ul> <p>Time-invariant:</p> <p></p>"},{"location":"inputs/#demand-and-flow-model-of-care","title":"Demand and Flow - Model of Care","text":"<p>Patients are assigned a care model depending on their category.</p> <p></p>"},{"location":"inputs/#demand-and-flow-category_1","title":"Demand and Flow - Category","text":"<p>Patients needing conveyance are assigned a conveyance destination (ED or non-ED).</p> <p></p>"},{"location":"inputs/#demand-and-flow-ed-acuity","title":"Demand and Flow - ED Acuity","text":"<p>Patients are allocated an acuity based on their route to ED and category</p> <p></p>"},{"location":"inputs/#job-cycle-time","title":"Job Cycle Time","text":"<p>The inputs for the Job Cycle Time Components can be chosen as either Quantile-based or Stylistic parametrisation-based.</p> <p>The relevant components are:</p> <ul> <li>Travel to scene</li> <li>Time at scene</li> <li>Travel to site</li> <li>Unavoidable pre-handover</li> <li>Time to clear</li> <li>(pre-handover and time to allocate are emerging queuing model characteristics, not inputs)</li> </ul> <p> Fig. Example input \"Time at Scene\" JCT component (Quantile-based). For \u2018See and Treat\u2019 incidents, divided by categories.</p> <p> Fig. Example input \"Time at Scene\" JCT component (Stylistic-based). For \u2018See and Convey\u2019 incidents, divided by categories.</p>"},{"location":"inputs/#supply-hourly-schedule","title":"Supply- Hourly Schedule","text":"<p>The supply schedule is made up of a dataframe which covers hourly resources available for:</p> <ul> <li>Number of double staffed vehicles (DSV/DSA) (calculated from hourly and weekday proportions of actual number of ambulances available from selected geography in selected time period)</li> <li>Relative hourly ED supply (calculated from hourly, weekday and week-on-week relative proportions)</li> </ul> <p>Note: other options available, see User guide - Parameter input files.</p> <p></p>"},{"location":"insights/","title":"Evidence and Insights (Assumptions)","text":"<p>Note Collation of insights exercise available internally as some of these leverage internal data, modelling or stakeholder insights. a An overview of the considerations to gather such insights is given below.</p> <p>Insights supported the project both in terms of model context and scope; model formulation; parametrisation; calibration; validation and relevant use cases.</p> <p>In the previous section the used data assets and data publications were mentioned. Other forms of insight, whether based off of such data assets or alongside them, include academic and gray literature, internal analysis and modelling pieces, operational procedures and subject-matter-expert knowledge and judgement.</p> <p>On one hand, these existing insights beyond core data assets can help direct the exploratory analysis and the model specification more efficiently. For instance, with regards to already known patterns or sources of variation in demand, flow, supply, job cycle time or ED characteristics.</p> <p>Further, while the model focusses on ambulance operational performance, such insights help to contextualise the work in terms of other key outcomes like clinical outcomes and staff experience, other healthcare settings, expected inter-trust variation or the macroenvironment (e.g. pandemic).</p> <p>Crucially also, some mechanisms such as dynamic escalations and behavioural changes in response to pressure may be hard to define and parametrise from existing data. These would need evidence-based assumptions.</p> <p>This includes:</p> <ul> <li>ED queue prioritisation</li> <li>Patient behavioural - balking, reneging, redirection to walk-ins</li> <li>Double Services Ambulance (DCA) fleet available for step-up</li> <li>Use of interventions (e.g. cohorting)</li> <li>Impact of pressure on allocation (conveyance, dispatch, no-send)</li> <li>ED queue prioritisation</li> <li>ED escalations (capacity, early discharge) when under pressure</li> <li>Other known standard operating procedures and/or behavioural changes when under pressure</li> </ul> <p>Where addressed, this could be either based on:</p> <ul> <li>Empirical emerging evidence, data-driven historic empirical relations (e.g. conveyance % as a function of Cat2-response time or another pressure-indicative KPI).</li> <li>Written procedures under normal operations and different levels of escalation.</li> <li>SME feedback, namely capturing anectodal evidence or information from local data sources.</li> <li>Modeller baseline assumption, which could be improved namely via calibration.</li> </ul>"},{"location":"insights/#some-useful-reads","title":"Some useful reads","text":"<p>A small subset of useful background reads is given below:</p> <p>NHS England, Operational productivity and performance in English NHS ambulance trusts: unwarranted variations (Lord Carter's review, 2018)</p> <p>NHS England, Delivery plan for recovering urgent and emergency care services (January 2023)</p> <p>AACE, Delayed hospital handovers: impact assessment of patient harm (November 2021)</p> <p>Nuffield Trust, Ambulance handover delays (2023)</p> <p>Nuffield Trust, Ambulance response times (2023)</p>"},{"location":"interpretoutput/","title":"Overview of output files","text":"<p>This section explains the meaning of the output files.</p>"},{"location":"interpretoutput/#output-patient-pathway-simmer","title":"Output - patient pathway (Simmer)","text":""},{"location":"interpretoutput/#output-logs","title":"Output - logs","text":"<p>Full simulation logs are saved if <code>flag_savedata_fulllogs &lt;- TRUE</code> in <code>config.R</code>.</p> <p>These will be large if used for very large simulations (e.g. high number of replications / volume of arrivals / attributes) so if not directly needed at this granularity, could be turned off.</p> File Description log_arrivals A log of arrivals (demand). Both ambulance and direct. Each row is an arrival. log_resources An event log of resource use. Both double staffed vehicles and ED. A new row signals a timestamp in which either the queue, occupancy or capacity of a resource changed. log_attributes_w A log of arrivals and their various characteristics and notable timestamps. Attributes saved are defined in the trajectory.R specification."},{"location":"interpretoutput/#output-log-of-arrivals","title":"Output - log of arrivals","text":"<p>Variables in <code>log_arrivals.xlsx</code>.</p> File Description name Unique patient identifier. start_time Start of activity. end_time End of activity (model exit) activity_time Difference between start and end time finished Flag on whether activity had finished by the end of the simulation replication The model run replication number"},{"location":"interpretoutput/#output-log-of-resources","title":"Output - log of resources","text":"<p>Variables in <code>log_resources.xlsx</code>.</p> Variable Description resource Resource (server) type. time Timestamp marking change in utilisation profile from previous row's characteristics server Number patients in server queue Number patients in queue for that server capacity Capacity of that server queue_size Maximum allowed queue size of that server (#NUM means infinite) system Number patients in server system (in queue or in server itself) limit Maximum allowed system (queue+server) size (#NUM means infinite) replication The model run replication number id n/a"},{"location":"interpretoutput/#output-log-of-attributes","title":"Output - log of attributes","text":"<p>Variables in <code>log_attributes_w.xlsx</code>.</p> Variable Description name Unique patient identifier (prefix \"PatientD_\" if Direct/Walk-In) replication The model replication number id nan Cat The ambulance category (1,2,3,4). Will be blank for Direct/Walk-In. Convey The care model (1=S&amp;C ; 2=S&amp;T; 3=H&amp;T). Will be blank for Direct/Walk-In. T_timetoscene The sampled time to scene interval (seconds) T_timeatscene The sampled time at scene interval (seconds) T_timetosite The sampled time to site interval (seconds) T_unavprehand The sampled unavailable pre-handover time interval (seconds) T_timetoclear The sampled time to clear interval (seconds) t_Rclockstart The timestamp of response time clock start (here same as arrival) n_resources_allocate The sampled number of resources to allocate. n_resources_arrive The sampled number of resources to arrive at site. t_ambulanceseized The timestamp at which an ambulance could be seized / allocated. t_hospitalarrival The timestamp of hospital arrival. Acuity The sampled acuity (1=highest/resus ; 5 = lowest/minor) LoS Defined time in A&amp;E department. t_EDhandover The timestamp of ED handover t_Rclockstop The timestamp of response time clock stop / arrival at scene Done Indication of whether the activity is done by the endo f the simulation and how (1=S&amp;C ; 2=S&amp;T ; 3=H&amp;T; 0=Direct; blank means not finished) t_JCTend The timestamp of the job cycle time end (ambulance perspective) ConveyDestED The conveyance destination t_ambclear The timestamp the ambulance cleared t_EDclockstop The timestamp of ED clock stop (end of time in A&amp;E) T_allocate The resulting time to allocate interval (seconds) = t_ambulanceseized - t_Rclockstart T_prehandover The resulting time to handover interval (seconds)  = t_Edhandover - t_hospitalarrival T_JCT The resulting total JCT time interval (seconds) = t_JCTend - t_Rclockstart (this differs from a more classic definition that excludes time from call connect to allocate as till that point no resource has been on the job) Kp_Tresponsetime The resulting responde time interval (seconds) = t_Rclockstop - t_Rclockstart T_ED The time in ED interval (seconds) = t_Edclockstop - t_Edhandover"},{"location":"interpretoutput/#output-kpi-files","title":"Output - KPI files","text":"<p>Overall (simulation time) KPIs are saved if <code>flag_savedata_overallKPIs &lt;- TRUE</code> in <code>config.R</code>.</p> <p>Step-wise (by steps of simulation time) KPIs are saved if <code>flag_savedata_stepwiseKPIs &lt;- TRUE</code> in <code>config.R</code>.</p> <p>Contrary to the full logs, these files save more post-processed KPIs (though all resulting from those two logs).</p> <p>KPIs include:</p> <ul> <li>Response times (Cat1, 2, 3, 4) - mean and 90th percentile</li> <li>Handover delays 30+ (%)</li> <li>Handover delays 60+ (%)</li> <li>Total time lost to handover delays (TLAHD)</li> <li>Total job cycle time (JCT)</li> <li>Double crewed ambulance (DCA) time  - mean, sd</li> <li>Time to allocate - mean, sd</li> <li>Call queue (queueing for an ambulance)</li> <li>Site queue (queueing for ED)</li> <li>Resource utilisation (%) - mean, sd</li> </ul> <p>Replication or batch: Some files give results \"by replication\" while others summarise these further \"across replications\" (\"batch\"). This is indicated in the table below.</p> <p>If batch - replication aggregate or flat: In some cases, this \"batch\" KPI is derived by considering all arrivals regardless of replication (\"flat\"). In others, the batch KPI is found by first calculating the KPI per replication and then finding the mean and standard deviation of this KPI among replications (\"aggregate\").</p> <p>Stepwise: Some KPIs are calculated for different steps (e.g. days, time windows) of the simulation window while other times they are calculated for the overall simulation time.</p> <p>Disaggregations: Where certain disaggregations were used, this is indicated (e.g. category for response times ; care model for time to allocate; resource type for utilisation; etc)</p> <p>An overview of the meaning of KPI output files is given below (navigate rightwards in the table to see all columns).</p> Filename Description KPI theme KPIs Statistical measures Replication or batch If batch - replication aggregate or flat Stepwise Disaggregations Comments row.xlsx Log of what-if levers in this scenario nan nan nan Batch nan nan nan nan df_scenarios.xlsx Log of what-if levels across scenarios nan nan nan Scenario nan nan nan nan KPI_overall_DCAtime.xlsx Double-crewed ambulance time DCA time DCA time median, mean, sd, n Batch Flat nan nan nan KPI_overall_HO.xlsx Handover delay KPIs Handover delays Handover delays HO30+, HO60+, TLAHD, n_ambu Batch Replication aggregate - mean, sd nan nan nan KPI_overall_HO_deciles.xlsx Handover delay KPIs Handover delays Handover delays Deciles Batch Flat nan nan nan KPI_overall_JCT.xlsx Job cycle time JCT JCT median, mean, sd, n Batch Flat nan nan nan KPI_overall_JCT_conv.xlsx Job cycle time JCT JCT median, mean, sd, n Batch Flat nan conveyance nan KPI_overall_val_cat.xlsx Average time to allocation; time for prehandover; job cycle time; response time, by category JCT components T_allocate; T_prehandover; T_JCT; T_responsetime mean, median Batch Flat nan category nan KPI_overall_val_catconv.xlsx Average time to allocation; time for prehandover; job cycle time; response time, by category and conveyance JCT components T_allocate; T_prehandover; T_JCT; T_responsetime mean, median Batch Flat nan category; conveyance nan KPI_overall_val_conv.xlsx Average time to allocation; time for prehandover; job cycle time; response time, by conveyance JCT components T_allocate; T_prehandover; T_JCT; T_responsetime mean, median Batch Flat nan conveyance nan KPI_step_CallStack.xlsx Call Stack by replication and simulation timestep interval Call Stack Call Queue mean Replication nan Yes nan nan KPI_step_HO.xlsx Handover delay KPIs by replication and timestep interval Handover delays Handover delays HO30+, HO60+, TLAHD, n_ambu Replication nan Yes nan nan KPI_step_RT.xlsx Response time KPIs by replication, timestep interval and category Response times Response times median, 90%ile, mean Replication nan Yes category nan KPI_step_SiteQueue.xlsx Site Queue by replication and simulation timestep interval Site queue Site Queue mean Replication nan Yes nan nan KPIbatch_overall_RT.xlsx Overall response time Response times Response time median, 90%ile, mean Batch Replication aggregate - mean nan nan nan KPIbatch_overall_RTcat.xlsx Response time by category Response times Response time median, 90%ile, mean Batch Replication aggregate - mean, sd nan category nan KPIbatch_overall_RU.xlsx Resource utilisation Resource utilisation Utilisation Utilisation Batch Replication aggregate - mean, sd nan resource type nan Queue Queue KPIbatch_overall_val.xlsx Batch-level average time to allocation; time for prehandover; job cycle time; response time JCT components T_allocate; T_prehandover; T_JCT; T_responsetime mean, median Batch Replication aggregate - mean, sd nan nan nan KPIflat_LoS Time in department by category Time in A&amp;E department Time in A&amp;E department mean Batch Flat - mean nan category nan KPIbatch_LoS Time in department by category by replication Time in A&amp;E department Time in A&amp;E department mean Replication nan nan category nan KPIrep_overall_HO Handover delay KPIs by replication Handover delays Handover delays HO30+, HO60+, TLAHD, n_ambu Replication nan nan nan nan KPIrep_overall_HT Overall response time by replication Response times Response time median, 90%ile, mean Replication nan nan nan nan KPIrep_overall_RT_cat Response time by category and replication Response times Response time median, 90%ile, mean Replication nan nan category nan KPIrep_overall_RU Resource utilisation by replication Resource utilisation Utilisation Utilisation Replication nan nan resource type nan Queue Queue KPIrep_overall_val_cat Average time to allocation; time for prehandover; job cycle time; response time, by category and replication JCT components T_allocate; T_prehandover; T_JCT; T_responsetime mean, median Replication nan nan category nan parameterlistaudit.xlsx An Rdata file keeping a log of most parameters (globals, user) used in the model rul nan nan nan nan nan nan nan nan"},{"location":"interpretoutput/#output-plot-files","title":"Output - plot files","text":"<p>A set of plots related to the KPIs are saved if  <code>flag_saveplots &lt;- TRUE</code> in <code>config.R</code>.</p> <p>Some plots may, depending on the nature of the scenario, benefit from different scaling of presentation. When a run ends, all plots are kept in memory as plot objects in a structure called <code>plot_list</code>. These can be further adapted with <code>ggplot</code> as needed, or for instance saved as vector files (<code>.svg</code>) for image processing.</p> <p>Alternatively, though we generate these plots for ease, all of them can be generated independently by the user from one of the three full logs.</p> <p>An overview of the plots is given below.</p> Filename Description Derived via plot_arri_cat_CM Arrivals over time, per category and conveyance. Arrivals for walk-ins (99). log of attributes plot_arri_cat_DnC Arrivals over time for three replications and by category. Demand input in black, supply schedule in red. log of attributes plot_Kp_HO_bp Handover KPIs stepwise over simulation time. Boxplots show variation among replications. Dashed horizontal lines will show reference levels given by user. log of attributes plot_Kp_HO_bp_y0 As 'plot_Kp_HO_bp' but starting at y=0 log of attributes plot_Kp_HO_bp_rep As 'plot_Kp_HO_bp'  but by replication (up to 3) log of attributes plot_Kp_RT90_bp_d14 90th percentile of response time by category, in the timestep. Boxplots show variation among replications. log of attributes plot_Kp_RT90_bp_d14 As 'plot_Kp_RT90_bp_d14' but vertically stacked. log of attributes plot_Kp_RTmean_bp_d14 Mean of response time by category, in the timestep. Boxplots show variation among replications. log of attributes plot_Kp_Rtmean_bp_ref_freey_d14 As 'plot_Kp_Rtmean_bp' but vertically stacked. Dashed horizontal lines will show reference levels given by user. log of attributes plot_Kp_Rtmean_bp_ref_freey0_d14 As 'plot_Kp_Rtmean_bp_ref_freey_d14' but starting at y=0. log of attributes plot_RU_instant_ Instantaneous utilisation of resources (ambulance, A&amp;E bay). Server capacity as dashed blue line. Server use as full blue line. Queues shown as filled red lines. Multiple traces correspond to multiple replications. log of resources plot_RU_KPI Overall utilisation of resources (ambulance, A&amp;E bay), % log of resources p_KPI_cq_1 Average calls queued per time step. Boxplots show variation among replications. Time step as 6 hours. log of attributes p_KPI_sq_1_day Average ambulances queued at ED per time step. Boxplots show variation among replications. Time step as 24 hours. log of attributes"},{"location":"problem/","title":"AmbSim - Project Scope","text":"<p>This project ran over the course of 12 weeks in Winter/Spring 2023.</p>"},{"location":"problem/#background","title":"Background","text":"<p>Ambulance handover problems have been dominating the Urgent &amp; Emergency Care (UEC) space. There are currently large handover delays, with a lot of people waiting a long time to be admitted into the emergency department (ED). </p> <p>The UEC recovery plan has been published . Within it, among other measures, it sets out a boost in capacity via the ambulance fleet over a two year period. </p>"},{"location":"problem/#exam-question","title":"Exam Question","text":"<p>What happens to Ambulance handover times / delays, and, ambulance response times, if you increase the number of ambulances within a system? As well as looking at changes in mean performance, we\u2019d also want to look at the distribution, and peaks.</p>"},{"location":"problem/#graphical-representation","title":"Graphical Representation","text":"<p>When a call is made, availability to respond to it depends namely on the number of on-duty ambulance fleet and the instantaneous availability to be allocated to that incoming call.  This in turn depends on when on-duty ambulances can be cleared from previous jobs (finish their job cycle time from allocation to clearance). Handover delays are leading to more ambulances queueing at the hospital site and an increase in job cycle time, which affects their availability for subsequent jobs.</p> <p> </p> <p>The system to be modelled includes patient demand for A&amp;E split into categories and conveyance routes.  Ambulances are allocated from a changing supply and act out a process time split into several \u201cjob cycle time\u201d stages.  Some patients will not be conveyed to A&amp;E but instead have a \u201csee and treat\u201d model osf care.  Those arriving at A&amp;E will queue for a bay alongside the direct walk-ins before being allocated a bay for a set amount of time. </p>"},{"location":"problem/#approach","title":"Approach","text":"<p>Suggest using the open source R package RSimmer building off the back of previous ambulance DES work.  SimPy was also considered but previous related work has been done in RSimmer and SimPy requires a significant setup time to create the simulation objects and logging.  A Large range of Licensed software was also considered but it is preferable to work in software which is more collaborative and we don't imagine needing the additional functionality that the licensed software brings for this task. </p>"},{"location":"results/","title":"Results","text":"<p>Note Internal NHSE documentation for the results of Phase 1 of the work (March-April 2023) and Phase 2 of the work (April-May 2023) not made public. Outputs from the Toy / Fake scenarios shown below to exemplify outputs.</p> <p>The \"foundation\" outputs of the model are the Log of Arrivals (log_arrivals.xlsx) and the Log of Attributes (log_attributes_w.xlsx).</p> <p>These will be saved if <code>flag_savedata_fulllogs &lt;- TRUE</code> in <code>config.R</code> (a reason to set this to False may be avoiding to save large files unnecessarily).</p> <p>All relevant graphical visualisations and summary metrics can likely be created from these.</p> <p>The script <code>post-processing.R</code> already has specified and produces a range of outputs based on those logs, both in table and visual format. These are shown below.</p> <p>Alternatively, the end-user is free to do their own post-processing with the logs given.</p>"},{"location":"results/#example-outputs-from-fake_data_1a","title":"Example outputs from Fake_Data_1A","text":"<p>This pre-created scenario uses a fictitious set of parameters for demand, capacity and job cycle times for a smaller scale toy example. It creates a step disruption in A&amp;E bays available from the 8th day (reducing bays by 8, from 73 to 65).</p> <p>Example outcomes from <code>parameters/Fake_Data_2/</code> scenario , with <code>n_AEbays &lt;- 73</code>, <code>T_AE &lt;- 6.5</code>, <code>flag_LoS_file &lt;- TRUE</code>, <code>dn_AEsupplyshock &lt;- -8</code>. Outputs can be seen in <code>example_outputs/Fake_Scenario2_1</code>.</p>"},{"location":"results/#demand-and-capacity","title":"Demand and Capacity","text":"<p>Figure Red traces represent queues forming. Continuous blue traces represent occupancy, with dashed blue traces showing capacity. The multiple traces relate to the 10 replications run. After 7 days, a disruption is imposed by reducing A&amp;E bays. The effect of this on queues, both for the A&amp;E bays and for the upstream ambulance activity, can be seen. </p>"},{"location":"results/#response-time-kpis","title":"Response time KPIs","text":"<p>Figure Mean response time KPIs per category and per simulation time-steps. Boxplots showing inter-replication variation. Dashed line is dummy, can be used to benchmark. </p>"},{"location":"results/#handover-kpis","title":"Handover KPIs","text":"<p>Figure Handover KPIs per simulation time-steps. Boxplots showing inter-replication variation. Dashed line is dummy, can be used to benchmark. </p>"},{"location":"results/#events-and-pathway-visualised","title":"Events and pathway visualised","text":"<p>NOTE: Contrary to the other outputs shown, for the code used to generate these static and animated pathways, please refer to our Process Mining repository [TBA]. Subfolder [TBA] shows scripts for this AmbModelOpen use case.</p>"},{"location":"results/#pathway-mean-times-and-branching-week-1-vs-week-2","title":"Pathway 'mean times' and branching % - week 1 vs week 2","text":"<p>Week 1 (before disruption) - % per branch</p> <p>Week 1 (before disruption) - mean time</p> <p>Week 2 (ongoing disruption) - % per branch</p> <p>Week 2 (ongoing disruption) - mean time</p>"},{"location":"results/#pathway-animated-first-week-before-disruption","title":"Pathway animated - first week (before disruption)","text":"<p>This animation only relates to days 1-7, so before step disruption. Calendar dates are fictitious. Colours relate to care model.</p> <p>Embedded below or seen in full screen here.</p>"},{"location":"results/#pathway-animated-scenarios-with-and-without-disruption","title":"Pathway animated - scenarios with and without disruption","text":"<p>This animation is similar to the previous one, but animates for the two weeks. Also, the top branch (<code>B-Base scenario</code>) shows the case where no disruption occurs at all. The bottom branch (<code>D-Disrupted scenario</code>) shows the case where step disruption occurs from day 7. Colours relate to breaches (of either category2 response time at 90th %ile, handover of 30+ minutes or both).</p> <p>Embedded below or seen in full screen here.</p>"},{"location":"results/#example-outputs-from-fake_data_2","title":"Example outputs from Fake_Data_2","text":"<p>This pre-created scenario uses a fictitious yet realistic set of parameters for demand, capacity and job cycle times for a toy ambulance trust.</p> <p>Example outcomes from <code>parameters/Fake_Data_2/</code> scenario , with <code>n_AEbays &lt;- 1500</code>, <code>T_AE &lt;- 6.5</code>, <code>flag_LoS_file &lt;- FALSE</code>, <code>dn_AEsupplyshock &lt;- 0</code>. Outputs can be seen in <code>example_outputs/Fake_Scenario2_1</code>.</p>"},{"location":"results/#demand","title":"Demand","text":"<p>Figure Demand per category and conveyance (colour-coded ; 1 - see and convey; 2 - see and treat; 3 - hear and treat; 99 - direct ED) </p>"},{"location":"results/#demand-and-supply","title":"Demand and supply","text":"<p>Figure Incident demand per category (colour-coded ; categories 1-4). 3 replications shown. Direct ED demand excluded. Black trace - input demand. Red-trace - input DSV supply </p>"},{"location":"results/#resource-utilisation-kpis","title":"Resource utilisation KPIs","text":""},{"location":"results/#instantaneous-utilisation-capacity-and-queue-traces","title":"Instantaneous utilisation, capacity and queue traces","text":"<p>Figure Instantaneous resource usage for respectively ambulance and A&amp;E bay. Dashed blue - server capacity ; Solid blue traces - server use ; Solid red traces - queues . Multiple traces due to n=10 replications. </p>"},{"location":"results/#utilisation-kpis-batch-overall-simulation-time","title":"Utilisation KPIs - batch, overall simulation time","text":"<p>Figure Utilisation and queue for A&amp;E bay and ambulance. Average and standard deviation. </p>"},{"location":"results/#response-time-kpis_1","title":"Response time KPIs","text":"<p>Figure Mean response time KPIs per category and per simulation time-steps. Boxplots showing inter-replication variation. Dashed line is dummy, can be used to benchmark. </p> <p>Table Response time KPIs (mean, median, 90th) averaged across simulation time and replications (mean, standard deviation)</p> <p>KKPIbatch_overall_RTcat.xlsx</p>"},{"location":"results/#handover-kpis_1","title":"Handover KPIs","text":"<p>Figure Handover KPIs per simulation time-steps. Boxplots showing inter-replication variation. Dashed line is dummy, can be used to benchmark. </p> <p>Table Handover KPIs averaged across simulation time and replications (mean, standard deviation)</p> <p>KPI_overall_HO.xlsx</p>"},{"location":"results/#select-job-cycle-time-kpis","title":"Select Job Cycle Time KPIs","text":"<p>Table KPIs 'Time to allocate' , 'Time for pre-handover', 'Total job cycle time', 'Response time', per conveyance. Mean and median.</p> <p>KPI_overall_val_conv.xlsx</p>"},{"location":"results/#call-queue-kpis","title":"Call queue KPIs","text":"<p>Figure Average call queue KPI per simulation time-steps (6 hour window). Boxplots showing inter-replication variation. </p>"},{"location":"results/#hospital-site-queue-kpis","title":"(Hospital) site queue KPIs","text":"<p>Figure Average site queue KPI per simulation time-steps (24 hour window). Boxplots showing inter-replication variation. </p>"},{"location":"run/","title":"Model Build Summary","text":"<p>The model is run as a discrete event simulation using the RSimmer package.  This type of modelling requires a \"trajectory\" to be fed with a realistic demand which then moves through the trajectory based on evidence based assumptions and resource supply usage.  The time it takes for the demand to make its way through the system and the utilisation of resources required for this can be monitored.  Each of these components will be explain in more detail below. </p>"},{"location":"run/#trajectory","title":"Trajectory","text":"<p>For this problem we can state that there is a fairly consistent patient pathway or \"trajectory\" as patients enter the system through a 999 triage process, are allocated ambulance resources which have fairly consistent job cycle times and then are either treated at scene, conveyed to and ED or conveyed to a non-ED setting.  At the ED setting there may be the formation of a queue whilst handing over the patients.  This creates a relatively simple trajectory but one where the time delays and resource prioritisation are heavily impacted by other parts of the system.</p> <p> </p>"},{"location":"run/#demand","title":"Demand","text":"<p>The demand in this model comes from two main generators:</p> <ul> <li>Walk-ins (i.e. direct ED attendances)</li> <li>Ambulance incidents</li> </ul> <p>In this model, walk-in demand can vary over time (hourly). It can be attributed different levels of ED acuity, which will impact the way requests for ED resource (among themselves and in relation to ambulance demand) are prioritised.</p> <p>Ambulance incident demand can vary over time (hourly). The distribution of this demand by category can also vary hourly. Each ambulance incident will be attributed a certain care model. If this involves conveyance, the incident will be attributed a certain probability that conveyance is to ED. If conveyance is to ED, it will be attributed a given ED acuity. </p>"},{"location":"run/#resource-usage","title":"Resource Usage","text":"<p>The resources in this model are of two types:</p> <ul> <li>Double staffed vehicles (also known as double crewed ambulances)</li> <li>ED bays (a simplified resource unit for ED)</li> </ul> <p>Walk-ins will only compete for ED bay resource.</p> <p>Ambulance incident demand will compete for ambulance resource (unless they are Hear&amp;Treat or balk or renege). They will also compete for ED bay resource if the care model is See&amp;Convey.</p> <p>The priority for ambulances is determined by the category (1= highest; 4=lowest), though a mechanism is in place that if lower priority categories have waited a long time, they may have their priority increased.</p> <p>The priority for ED bays is based on ED acuity and a further calibrating parameter.</p>"},{"location":"run/#model-capabilities","title":"Model capabilities","text":"<p>The current model can:</p> <ul> <li>Set ambulance demand by hour, weekday and category with competitive walk-in demand for ED</li> <li>Set ambulance supply by hour and weekday</li> <li>Set ED bay supply by hour and weekday</li> <li>Set a renege time for patients to leave queue after a certain time (to simulate situation improving whilst waiting)</li> <li>Set balking criteria (to simulate patients taking themselves or using other services)</li> <li>Vary category three conveyance dynamically based on pressures i.e. increase the sea and treat proportion associated JCT components dynamically (to simulate changing behaviour of the ambulance allocations) </li> <li>Set more than one resource allocated and arriving at scene, per incident</li> <li>Set a portion of supply as \u2018holdout\u2019 for Category one only, always or as a trigger</li> <li>Escalate Category three and four calls if they have been waiting for more than X time (to simulate a balance in queue priority of category versus time waited)</li> <li>Set different time in ED department in the ED by category and source (direct vs ambulance)</li> <li>Simulate over 14 days for realistic levels of demand</li> <li>Monitor the utilisation of resources and the queues waiting for these resources</li> <li>Generate KPIs on response time, handover delays, queues and job cycle time components</li> <li>Run the simulation up to 3-25 times with different seeds in the time and allocation profiles.</li> <li>Run multiple scenarios / sensitivities in a loop and compile results</li> </ul> <p>The current model can't <code>*</code>:</p> <ul> <li>Escalate resources depending on time or simulation metrics (triggers)</li> <li>Vary behaviour of ED prioritisation based on pressures.</li> <li>Vary non face to face % dynamically based on pressures.</li> <li>Account for multiple EDs explicitly.</li> <li>Set rapid response vehicles as resource alongside double crewed ambulances.</li> </ul> <p><code>*</code> these can functionality-wise be implemented in Simmer/DES. A consideration of added-value to accuracy, added-value to decision-making and feasibility may determine which ones would be useful to implement. Where feasibility is a barrier this may mainly relate to knowledge of behavioural/escalation mechanisms and parametrisation.</p>"},{"location":"run/#assumptions","title":"Assumptions","text":"<p>An overview of key assumptions:</p> <ul> <li>The effect on clinical outcomes is assessed via other approaches.</li> <li>Sociodemographic considerations are assessed via other approaches.</li> <li>The model is used for what-if scenarios rather than for forecasting or an absolute depiction of the as-is.</li> <li>999/111 calls that do not become incidents are out of scope.</li> <li>Demand, capacity, distribution by category can be set as time-variant. Conveyance and demand (via balking, reneging) can be set to change dynamically. Other inputs are time-invariant.</li> <li>Ambulance resource is characterised through double crewed ambulances.</li> <li>The ED department, while not in core scope, is modelled at high level as a capacity-constrained resource with a certain time in department.</li> <li>Flow beyond the ED department is out of scope, while aknowledging the influence of such settings on upstream settings by developing what could be a module in a modular simulation.</li> <li>A useful model on the effect of interventions on response times and handover delays can be obtained without a fully geospatial or multiple-ED approach .</li> <li>TBA</li> </ul>"},{"location":"structure/","title":"Repository Structure","text":""},{"location":"structure/#folder-structure","title":"Folder structure","text":"<ul> <li><code>./src</code> - folder for source code.</li> <li><code>./parameters</code> - folder to house sub-folders. A sub-folder will include a set of Input parameter files for a given scenario that should be parametrised.</li> <li><code>./docs</code> - folder with MkDocs documentation</li> <li><code>./Outputs</code> - folder for run outputs subfolders</li> <li><code>./example_outputs</code> - folder with example outputs</li> </ul>"},{"location":"structure/#source-code-structure","title":"Source Code structure","text":"<p>Core:</p> <ul> <li><code>main.R</code> - main script from which libraries are loaded, parameters set, runs made and results processed.</li> <li>----- <code>trajectory.R</code> - trajectory definitions. Core element of <code>simmer</code> DES model.</li> <li>----- <code>config.R</code> - config (user inputs). File where various user inputs are set (apart from those loaded from file, though including flags on whether those should be used or not).</li> <li>----- <code>inputs.R</code> - script where inputs (data) are loaded from Input parameter files and pre-processing is done.</li> <li>----- <code>packages.R</code> - packages needed for run and results</li> <li>----- <code>post-processing.R</code> - post-processing . post-processing of logs (data wrangling, rules) to arrive at relevant metric dataframes and graphs (including demand; supply; utilisation metrics; handover metrics; response time metrics; queue metrics)</li> <li>----- <code>save.R</code> - various saving options for model output dataframes and plots</li> </ul> <p>An end-user would only be expected to interact with <code>config.R</code> and two lines in <code>main.R</code> on <code>scenario_folder</code> and <code>mydate</code>.</p> <p>A developer could interact with different code files depending on the use case.</p>"},{"location":"userguide/","title":"Parameter Input files for demand, supply, JCT","text":"<p>All file based parameters should be updated in a newly created folder within <code>/parameters</code> .</p> <p>The folder <code>Fake_Data_2</code> can be copied and renamed (e.g. to <code>NewRun</code>). This gives a pre-filled starting point from which assumptions can be changed as deemed fit.</p> <p>To use this parameter folder, in <code>main.R</code> update <code>scenario_folder</code> as appropriate, i.e. <code>scenario_folder&lt;-\"NewRun\"</code>.</p> <p>Note that whether individual files and parameters within the folder are loaded and used in the DES model runs will depend on whether relevant flags or controls have been turned on (e.g. in <code>config.R</code>). This is highlighted below for the relevant sections.</p>"},{"location":"userguide/#constituent-parameter-input-files-of-a-scenario-folder","title":"Constituent parameter input files of a scenario folder","text":"<p>The model expects the following parameter input files to be present in the folder:</p> <ul> <li><code>JCT_v_type.xlsx</code> - file to specify whether JCT components are set based on quantiles or stylistic (parametric) distributions.</li> <li><code>JCT_m_q.xlsx</code> - file that specifies the distributions for JCT components based on quantiles, by category and model of care.</li> <li><code>JCT_m_style.xlsx</code> - file that specifies the distributions for JCT components based on stylistic distributions (constant or lognormal).</li> <li><code>m_demand_cat2conv.xlsx</code> - file that specifies demand by category ; model of care by category ; time in A&amp;E department ; ED acuity by category or direct attendance; % conveyance to ED.</li> <li><code>v_DnC_schedule.xlsx</code> - file that specifies demand (ambulance, direct) and capacity (double staffed vehicles, ED) profiles over time.</li> </ul>"},{"location":"userguide/#input-file-m_demand_cat2convxlsx","title":"Input file 'm_demand_cat2conv.xlsx'","text":"<p>This file allows for a series of inputs to be given, mostly related to relative distributions in demand.</p> <p>Tab <code>Checks</code> will perform some checks to ensure data is internally consistent and coherent. Flags will indicate if there are issues.</p> <p>Tab <code>Sources</code> can be used to log the origin of the data.</p> <p>Each other tab will allow the parametrisation of a different relation.</p>"},{"location":"userguide/#provide-the-relative-model-of-care-by-acuity","title":"Provide the relative model of care by acuity","text":"<ul> <li>Navigate to sheet 'm_demand_cat2conv'</li> <li>In the matrix, provide for each Category the relative distribution of demand by model of care (SeeConvey vs SeeTreat vs Hear Treat).</li> <li>Good to know:<ul> <li>Each row should add to 100%.</li> <li>Each value should be between 0-100%</li> </ul> </li> <li>Suggested sources: AmbSYS ; daily ambulance collection</li> <li>Run use: will be used; MUST define</li> </ul>"},{"location":"userguide/#provide-the-relative-acuity","title":"Provide the relative acuity","text":"<ul> <li>Navigate to sheet 'v_demand_cat'</li> <li>In the matrix, provide the relative distribution of demand by category.</li> <li>Good to know:<ul> <li>The column should add to 100%</li> <li>Each value should be between 0-100%</li> </ul> </li> <li>Suggested sources: AmbSYS ; daily ambulance collection</li> <li>Run use: will be used and MUST be defined unless in parameter file <code>v_DnC_schedule.xlsx</code> sheet <code>Controls</code>, the user has set <code>Should category distribution vary over time?</code> to <code>Yes</code>.</li> </ul>"},{"location":"userguide/#provide-the-time-in-department-by-category","title":"Provide the Time in Department by category","text":"<ul> <li>Navigate to sheet 'v_LoS'</li> <li>In the matrix, provide the Time in Department by Category (hours).</li> <li>Good to know:<ul> <li>Each value should be greater than 0.</li> </ul> </li> <li>Suggested sources: ECDS time in department; ECDS-NACC linkage; judgemental</li> <li>Run use: will be used only if in <code>config.R</code> file <code>flag_LoS_file&lt;-TRUE</code> . Otherwise model run will use as specified in <code>config.R</code> <code>T_AE</code> (<code>flag_scenarios=FALSE</code>) or <code>vec_T_AE</code> (<code>flag_scenarios=TRUE</code>).</li> </ul>"},{"location":"userguide/#provide-the-relative-conveyance-destination","title":"Provide the relative Conveyance Destination","text":"<ul> <li>Navigate to sheet 'v_conveydestination'</li> <li>In the matrix, provide the % of those conveyed that go to ED (as opposed to non-ED)</li> <li>Good to know:<ul> <li>Each value should be between 0-100%</li> </ul> </li> <li>Suggested sources: AmbSYS ; daily ambulance collection</li> <li>Run use: will be used and MUST be defined.</li> </ul>"},{"location":"userguide/#provide-the-direct-ed-demand-as-a-ratio-of-ambulance-conveyance-demand","title":"Provide the direct ED demand as a ratio of ambulance conveyance demand","text":"<ul> <li>Navigate to sheet 'v_direct_ratio'</li> <li>In the cell, provide the ratio of ED direct attendance relative to ambulance conveyance. That is, for each ambulance conveyance, how many ED direct attendances are there.</li> <li>Good to know:<ul> <li>The value should be non-negative.</li> </ul> </li> <li>Suggested sources: ECDS attendance source</li> <li>Run use: will be used and MUST be defined unless in <code>config.R</code> the <code>flag_demand_schedule &lt;- TRUE</code>, in which case it will load the direct demand trendline from <code>v_DnC_schedule.xlsx</code>.</li> </ul>"},{"location":"userguide/#provide-the-relative-ed-acuity-by-category-and-direct","title":"Provide the relative ED acuity by Category (and Direct)","text":"<ul> <li>Navigate to sheet 'v_direct_acuity'</li> <li>In the matrix, provide for each Category (and Direct) attendances, the relative distribution of ED acuity.</li> <li>Good to know:<ul> <li>Each column should add to 100%</li> <li>Each value should be between 0-100%</li> <li>Acuity dictates priority of ED handover in the model (dealing with \"competitive\" nature of direct vs ambulance attendances for resource)</li> </ul> </li> <li>Suggested sources: ECDS acuity, ECDS-NACC linkage, judgemental / calibration of handover delays</li> <li>Run use: will be used and MUST be defined.</li> </ul>"},{"location":"userguide/#input-file-jct_m_typexlsx","title":"Input file 'JCT_m_type.xlsx'","text":"<p>The period for different Job Cycle time components can be defined in two main ways:</p> <ul> <li>As Quantiles, i.e. establishing that X% of events occur under a timeperiod of Y, for a range of X values.</li> <li>As Style, i.e. as a stylised parametric distribution - currently this can be either a constant or a lognormal.</li> </ul> <p>This file requires the user to specify from the dropdown which type they would like to use for each JCT component. This will in turn dictate, for each respective JCT component, from which workbook the information will be loaded and applied during the run (`JCT_m_style.xlsx for Style ; JCT_m_q.xlsx for Quantiles).</p> <p>Header meaning:</p> <ul> <li>tts - time to scene</li> <li>tas - time at scene</li> <li>ttsi - time to site</li> <li>uph - unavoidable pre-handover (defining the minimum handover, independent and on top of that emerging from the model's handover ED resource request)</li> <li>ttc - time to clear</li> </ul> <p></p>"},{"location":"userguide/#input-file-jct_m_qxlsx","title":"Input file 'JCT_m_q.xlsx'","text":"<ul> <li>Each sheet refers to a different JCT component.</li> <li>The configuration of each sheet is the same.<ul> <li>Yellow cells need filling.</li> <li>It expects the user to provide, in minutes, the {1,10,20,30,40,50,60,70,80,90,99}th %ile (q) of that component. This can be used by the DES model to sample time intervals from for each patient.</li> <li>Four columns are given, one per category.</li> <li>Row-wise (long-format), data can be given for 3 care models (CM=1 is see and convey; CM=2 is see and treat; CM=3 is hear and treat).</li> <li>In practice this means that separate distributions can be given by component x category x care model.</li> </ul> </li> <li>Good to know:<ul> <li>Each value should de greater or equal to zero</li> <li>Each quantile vector q from 1%ile to 99%ile should be increasing in monotony - i.e. it would not make sense for the value to drop.</li> <li>In practice, CM=3 has no meaning for any of the JCT components (hence cells in blue in all sheets).</li> <li>In practice, CM=2 has no meaning beyond <code>timeatscene</code> (hence cells in blue in the following sheets)</li> </ul> </li> <li>Suggested sources: JCT components informed by CADS / ADS ; model ambulance in model health system; judgemental.</li> <li>Run use: will be used and MUST be defined if 'Quantiles' selected in <code>JCT_m_type.xlsx</code>.</li> </ul>"},{"location":"userguide/#input-file-jct_m_stylexlsx","title":"Input file 'JCT_m_style.xlsx'","text":"<ul> <li> <p>Each of the first five sheets refers to a different JCT component. </p> </li> <li> <p>The configuration of those sheets is the same.</p> <ul> <li>Yellow cells can be filled as needed.</li> <li>The purpose of each sheet is to parametrise the distribution of that JCT component based on a parametric distribution, via a 'param' vector. Currently, the following two have been implemented and would be recognised by the DES model (could be expanded):<ul> <li>'rlnorm' - lognormal</li> <li>'cons' - constant (fixed)</li> </ul> </li> <li>'param' specification allows for 5 values, these should be used as follows (see also table below):<ul> <li>Use param5 to choose the distribution from the dropdown (rlnorm or cons)</li> <li>If param5 is 'rlnorm':<ul> <li>param1 is the logmean</li> <li>param2 is the logsd</li> <li>param3,4 ignored</li> </ul> </li> <li>If param5 is 'cons':<ul> <li>param1 is the constant value / mean</li> <li>param2,3,4 is ignored</li> </ul> </li> <li>The way parameters 1-4 are used is meant to be aligned with their use in packages such as fitdistr.</li> </ul> </li> <li> <p>Four columns are given, one per category. Row-wise (long-format), param is given for 3 care models (CM=1 is see and convey; CM=2 is see and treat; CM=3 is hear and treat). In practice this means that separate param specification are given by component x category x care model. Param for all relevant JCT components (sheet) x Care Model (row) x Category (column) should be specified.</p> </li> <li> <p>Sheet <code>Checks</code> allows for some interpretation of the distributions - namely, via plotting and by showing what would be the expected mean and standard deviation of the resulting sample distribution.</p> </li> <li> <p>Sheet <code>simple parametrisation</code> is a simple \"aid\" page in case the user would like to do the inverse operation, i.e. input a given observed sample mean and standard deviation and derive that the relevant parameters (e.g. logmean and logsd for the lognormal distribution) would be. This is at a very simple level. For more advanced distribution fitting from empirical data (either histogram-like or quantile-like, see auxiliary R script <code>utility_stylised.R</code>).</p> </li> <li> <p>Sheet <code>Ref</code> provides some lookups, namely the meaning of the parameters for a given distribution (See Table below).</p> </li> </ul> </li> </ul> param constant(mean) lognormal(logmean,logsd) 1 mean logmean 2 n/a logsd 3 n/a n/a 4 n/a n/a 5 cons rlnorm <ul> <li>Good to know:<ul> <li>In practice, CM=3 has no meaning for any of the JCT components (hence cells not in yellow).</li> <li>In practice, CM=2 has no meaning beyond <code>timeatscene</code> (hence cells not in yellow in the following sheets)</li> <li><code>Checks</code> can be used to visualise resulting distributions ; <code>simple parametrisation</code> can be used to derive a rlnorm(logmean,logsd) from a desired sample mean and standard deviation; <code>utility_stylised.R</code> and its libraries can be used for more detailed investigations into appropriate distribution fitting.</li> </ul> </li> <li>Suggested sources: JCT components informed by CADS / ADS ; model ambulance in model health system; judgemental.</li> <li>Run use: will be used and MUST be defined if 'Style' selected in <code>JCT_m_type.xlsx</code>.</li> </ul> <p></p>"},{"location":"userguide/#input-file-v_dnc_schedulexlsx","title":"Input file 'v_DnC_schedule.xlsx'","text":"<p>This file is used to give information on the demand and supply profiles. These are given as a time-series (time unit hour).</p> <p>The information read and used by the DES model is that given in:</p> <ul> <li>Demand-Enforced</li> <li>Supply-Enforced</li> </ul> <p>A couple of parameters are also read into R from 'Controls'.</p> <p>Other sheets are largely auxiliaries to help the user populate those two main sheets.</p>"},{"location":"userguide/#sheet-controls","title":"Sheet <code>Controls</code>","text":"<p>Largely, this sheets controls how <code>Demand-Enforced</code> and <code>Supply-Enforced</code> should be specified based on the background sheets.</p> <ul> <li> <p>Controls - Demand</p> <ul> <li>Which profile: ' As_components' vs 'Fully custom' : choose whether ambulance incident demand should come from sheet <code>Demand - As_components</code> or from <code>Demand - Fully_custom</code></li> <li>Which profile: 'uplift from ambulance incidents' vs 'Fully custom' : choose whether direct ED demand should come from sheet <code>Demand - As_components</code> or from <code>Demand - Fully_custom</code> or be a simple scalar applied to the ambulance incident demand</li> <li>Uplift factor: Specify the uplift factor that should be used, if enabled. i.e. for every ambulance incident (upstream), how many direct ED attendances.</li> <li><code>Should category distribution vary over time?</code>: choose whether to ignore or not the category distribution over time in the DES model demand generator. If <code>Yes</code>, information in columns C1,C2,C3,C4 of <code>Demand-Enforced</code> will be leveraged in the DES model. If <code>No</code>, information in those columns will be ignored and instead the data in 'm_demand_cat2conv.xlsx' <code>v_demand_cat</code> (time-invariant) will be used.</li> </ul> </li> <li> <p>Controls - Supply</p> <ul> <li> <ul> <li>Which profile: ' As_components' vs 'Fully custom' : choose whether RSV and ED supply should come from sheet <code>Supply - As_components</code> or from <code>Supply - Fully_custom</code></li> </ul> </li> </ul> </li> </ul> <p></p>"},{"location":"userguide/#sheet-demand-enforced","title":"Sheet <code>Demand-Enforced</code>","text":"<p><code>Demand-Enforced</code> is ingested into the DES model to inform demand profiles. Its columns are filled based on information given in Controls and based on the <code>Demand _ [...]</code> auxiliary sheets.</p> <ul> <li> <p>Meaning:</p> <ul> <li>Day - day of the simulation</li> <li>Hour - hour of the day in the simulation</li> <li>Time - time in hours, starting at 0</li> <li>Incident_Demand - incident demand in that hour (rate)</li> <li>Direct_Demand - direct ED demand in that hour (rate)</li> <li>C1, C2, C3, C4 - the relative portion of incident demand by category. These four columns should add to 100%</li> </ul> </li> <li> <p>Good to know:</p> <ul> <li>Check that each time series makes sense, based on information given in <code>Control</code> and in the <code>Demand _ [...]</code> auxiliary sheets.</li> <li>Check that <code>config.R</code> is set to ingest and leverage these, if so desired.</li> </ul> </li> <li>Run use: will be used only if <code>flag_demand_schedule &lt;- TRUE</code> in <code>config.R</code> ; relative demand by category (C1,C2,C3,C4) only used if activated in the <code>Control</code> sheet of the same workbook.</li> </ul>"},{"location":"userguide/#sheet-supply-enforced","title":"Sheet <code>Supply-Enforced</code>","text":"<p><code>Supply-Enforced</code> is ingested into the DES model to inform supply profiles. Its columns are filled based on information given in Controls and based on the <code>Supply _ [...]</code> auxiliary sheets.</p> <ul> <li> <p>Meaning:</p> <ul> <li>Day - day of the simulation</li> <li>Hour - hour of the day in the simulation</li> <li>Time - time in hours, starting at 0</li> <li>DSV_Enforced - DSV vehicles on-duty</li> <li>ED_Enforced_torescale - a relative profile of ED capacity over time, the mean value of which is set in the <code>config.R</code> parameter <code>n_AEbays</code> (by standardising / rescaling the former)</li> <li>Incident_Demand - (just used for plotting)</li> <li>ED_enforced_plot_rescale - (just used for plotting)</li> </ul> </li> <li> <p>Good to know:</p> <ul> <li>Check that each time series makes sense, based on information given in <code>Control</code> and in the <code>Supply _ [...]</code> auxiliary sheets.</li> <li>Check that <code>config.R</code> is set to ingest and leverage these, if so desired.</li> </ul> </li> <li>Run use: DSV schedule will be used only if <code>flag_supply_schedule &lt;- TRUE</code> and <code>flag_supply_schedule_file &lt;- TRUE</code> in <code>config.R</code> . ED schedule will be used only if  <code>flag_supply_schedule &lt;- TRUE</code> and <code>flag_supply_schedule_file_hED &lt;- TRUE</code> in <code>config.R</code> </li> </ul>"},{"location":"userguide/#sheet-demand-fully_custom","title":"Sheet <code>Demand - Fully_custom</code>","text":"<ul> <li>Fill in information in the yellow cells.</li> <li>Good to know:<ul> <li>Column <code>Check</code> flags if columns C1, C2, C3, C4 add to 100%.</li> <li>If this information should be used, check that <code>Controls</code> is currectly set up and that information is flowing into <code>Demand-Enforced</code>. See also the <code>Good to Know</code> from the <code>Demand-Enforced section</code>.</li> </ul> </li> <li>Suggested sources:<ul> <li>For incident demand: ADS; CADS; daily ambulance collection</li> <li>For direct ED demand and ratio: ECDS (attendances; admission source)</li> </ul> </li> </ul>"},{"location":"userguide/#sheet-demand-as_components","title":"Sheet <code>Demand - As_components</code>","text":"<ul> <li>Fill in information in the yellow cells.</li> <li>For ambulance incident demand:<ul> <li>Fill the hourly demand component (this will be normalised)</li> <li>Fill the weekly demand component (this will be normalised)</li> <li>Fill the week on week demand component (absolute)</li> <li>Fill the scaling factor</li> <li>These factors are applied in a multiplicative way to generate a profile (column Incident_Demand and visualisations).</li> </ul> </li> <li> <p>For Direct ED demand:</p> <ul> <li>Fill the hourly demand component (this will be normalised)</li> <li>Fill the weekly demand component (this will be normalised)</li> <li>Fill the week on week demand component (will be normalised)</li> <li>The absolute scaling is dictated based in the <code>uplift_factor</code> in <code>Controls</code> and the aggregate ambulance demand.</li> <li>These factors are applied in a multiplicative way to generate a profile (column DirectED_Demand_Demand and visualisations).</li> </ul> </li> <li> <p>Good to know:</p> <ul> <li>If this information should be used, check that <code>Controls</code> is currectly set up and that information is flowing into <code>Demand-Enforced</code>. See also the <code>Good to Know</code> from the <code>Demand-Enforced section</code>.</li> </ul> </li> <li>Suggested sources:<ul> <li>For incident demand: ADS; CADS; daily ambulance collection</li> <li>For direct ED demand and ratio: ECDS (attendances; admission source)</li> </ul> </li> </ul>"},{"location":"userguide/#sheet-supply-fully_custom","title":"Sheet <code>Supply - Fully_custom</code>","text":"<ul> <li>Fill in information in the yellow cells.</li> <li>Good to know:<ul> <li>If this information should be used, check that <code>Controls</code> is currectly set up and that information is flowing into <code>Demand-Enforced</code>. See also the <code>Good to Know</code> from the <code>Demand-Enforced section</code>.</li> </ul> </li> <li>Suggested sources:<ul> <li>For DSV supply: NACC or judgemental or based on rotas</li> <li>For ED supply: judgemental or based on rotas; SEDIT tool (consultants, nurses, bays)</li> </ul> </li> </ul>"},{"location":"userguide/#sheet-supply-as_components","title":"Sheet <code>Supply - As_components</code>","text":"<ul> <li>Fill in information in the yellow cells.</li> <li>For double-staffed vehicle supply:<ul> <li>Fill the hourly capacity component (this will be normalised)</li> <li>Fill the weekly capacity component (this will be normalised)</li> <li>Fill the week on week on week capacity in vehicle hours (absolute)</li> <li>Fill the scaling factor</li> <li>These factors are applied in a multiplicative way to generate a profile (column DSV_Supply and visualisations).</li> </ul> </li> <li> <p>For ED supply:</p> <ul> <li>Fill the hourly demand component (this will be normalised)</li> <li>Fill the weekly demand component (this will be normalised)</li> <li>Fill the week on week demand component (will be normalised)</li> <li>These factors are applied in a multiplicative way to generate a profile (column <code>ED Supply to be rescaled</code> and visualisations).</li> <li>The absolute scaling is not relevant. It will be dictated by the <code>config.R</code> parameter on average hourly A&amp;E bay supply <code>n_AEbays</code>.</li> </ul> </li> <li> <p>Good to know:</p> <ul> <li>If this information should be used, check that <code>Controls</code> is currectly set up and that information is flowing into <code>Supply-Enforced</code>. See also the <code>Good to Know</code> from the <code>Supply-Enforced section</code>.</li> </ul> </li> <li> <p>Suggested sources:</p> <ul> <li>For DSV supply: NACC or judgemental or based on rotas</li> <li>For ED supply: judgemental or based on rotas; SEDIT tool (consultants, nurses, bays)</li> </ul> </li> </ul>"},{"location":"validation/","title":"Validation","text":"<p>Warning Validation available internally.</p>"}]}